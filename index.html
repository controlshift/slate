<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>ControlShift Labs API & Webhook Reference</title>
    <link rel="Shortcut Icon" href="http://www.controlshiftlabs.com/wp-content/themes/controlshift/images/favicon.ico" type="image/x-icon" />

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/controlshift.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img alt="ControlShift Labs" src="images/logo.png" />
        <div class="lang-selector">
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href="http://www.controlshiftlabs.com/">Sign Up for ControlShift Labs</a></li>
            <li><a href="https://github.com/tripit/slate">Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the <a href="http://www.controlshiftlabs.com/">ControlShift Labs</a> Developer documentation. Our APIs are designed to allow software engineers to create rich integrations between ControlShift content and third-party services and websites.</p>

<p>We offer several APIs to customers to cover different integration use cases. </p>

<ul>
<li><p><strong>JSONP API</strong> Unauthenticated API designed to be consumed by javascript clients written by front-end engineers. Quickly display public information about petitions, efforts, and users on external sites.  </p></li>
<li><p><strong>Webhooks</strong> Get notified when changes happen so external systems can react. </p></li>
<li><p><strong>Bulk Data</strong> Integrate your ControlShift instance with a data warehouse like Redshift for SQL access and reporting.</p></li>
<li><p><strong>Authenticated REST</strong> Server Side API integration option for more advanced scenarios. Uses OAuth2 to allow third-party developers to create applications and customers to grant access.</p></li>
</ul>

          <h1 id="json-api-endpoints">JSON API Endpoints</h1>

<p>The JSONP API is a simple way to embed ControlShift petition content in external sites. It&rsquo;s intended for use by a front-end developer embed content on web pages outside of the platform.  For example, a developer could:</p>

<ul>
<li>Show petitions</li>
<li>Allow a user to search for near by petitions</li>
<li>List petition categories</li>
<li>Show petitions within an effort</li>
<li>If a site visitor is logged in, show a users past actions and created petitions</li>
</ul>

<p>All of the endpoints can be consumed as JSONP instead of JSON by adding callback or variable parameters to the URLs.</p>

<p>The URL slugs through the API are the same as those that are used through the web to represent specific petitions or categories.  Many front-end libraries including jQuery make it easy to consume JSONP endpoints. Our examples below use jQuery to consume these resources.</p>

<aside class="success">
These examples use the domain <code>demo.controlshiftlabs.com</code>. You&rsquo;ll need to replace this with the hostname of your instance.
</aside>

          <h2 id="get-a-single-petition">Get a single petition</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">petitionSlug</span> <span class="o">=</span> <span class="s1">'turn-back-human-trafficking-faith-leaders'</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/petitions/'</span><span class="o">+</span><span class="nx">petitionSlug</span><span class="o">+</span><span class="s1">'.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above code would display your returned petition data in the console.  The JSON response data would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">107370</span><span class="p">,</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pledge to TURN BACK human trafficking Now - Faith or Community Leaders"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"President John Dramani Mahama"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Today there are over 192,000 people trapped in modern slavery in Ghana [1]. Denied of their rights to education and often lacking parental care or support, over 1.8 million Ghanaian children are working rather than in school (21.8% of the population). Of these an estimated 1.2 million are forced to undertake hazardous child labour including mining, fishing and domestic slavery [3].\r\n\r\nThe experience of Kwesi is a typical example. Following the death of his father, Kwesi’s mother borrowed money to pay for the funeral. Faced with a debt she was unable to pay her creditor threatened her with jail unless she gave up her son as a labourer.  Kwesi was trafficked to Lake Volta to work as a “fisher boy”. and for the next three years, Kwesi worked for an average of 18 hours per day with little rest, no pay and only enough food to give him the energy for more work. By the time we found Kwesi and rescued him, he had suffered extensive emotional and physical abuse and partially lost sight in his left eye. \r\n\r\nOver 21,000 children like Kwesi, many of them trafficked, are trapped in hazardous labour on Lake Volta in Ghana[2]. We are working hard to bring them home, but want to ensure no one is trafficked in the first place. Please help fulfil the wish made by Kwesi when he gained his freedom: “I want the world to know that no child should be sent into slavery”.\r\n\r\n[1]. http://www.globalslaveryindex.org/ 2014\r\n[2].International Labour Organisation/International Programme on Elimination of Child Labour (ILO/IPEC) Analytical Study on Child Labour In Lake Volta Fishing in Ghana\r\n[3].Ghana Living Standard Survey 6 (GLSS 6): Child Labour Report by Ghana Statistical Services, 2014"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I know that globally millions of people are trafficked for forced labour and sexual exploitation and that Ghana is a source, transit and destination country for this social evil. The concerns raised by Parliament recently, about men, women, and children who are trafficked and subjected to forced labor and sexual exploitation human points to the need for everyone to take action.\r\n\r\nI hereby pledge to TURN BACK human trafficking. \r\n•\tI will be vigilant of suspicious movement of children and vulnerable people, victims of bonded labour and of children working when they should be in school \r\n•\tI promise to always report my concerns to the appropriate authorities as quickly as possible.\r\n\r\nAs a faith or community leader, I promise to warn my congregation of the dangers of child trafficking, and support them in reporting any suspicions they have."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-01T15:37:47.621-04:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-14T08:45:52.396-04:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"turn-back-human-trafficking-faith-leaders"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"delivery_details"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"administered_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-07-29T09:32:08.258-04:00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nt">"location_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"alias"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bsd_constituent_group_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Civil Rights"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"civil-rights-1"</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"effort"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"turn-back-human-trafficking-now"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"resized_image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/hero/Untitled.png?1433187465"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/original/Untitled.png?1433187465"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Kristyn Arrighi"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This retrieves a single petition object.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://demo.controlshiftlabs.com/petitions/&lt;slug&gt;.json</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>slug</td>
<td>null</td>
<td>string - required - The petition&rsquo;s unique identification slug. If none is provided, you will get a 404 error. Note: submitted as a part of the endpoint path, not as a separate URL parameter</td>
</tr>
</tbody></table>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io:</p>

<div class="js-codepen-data hidden" data-title="ControlShift Labs: Single Petition Example">
  <div class="codepen-html">
    <div id="js-content-wrapper" class="hidden">
      <h1 id="title"></h1>
      <h3><span id="signature_count"></span> signatures</h3>
      <p>Created by <span id="creator_name"></span></p>
      <h2>What</h2>
      <p id="what"></p>
      <h2>Who</h2>
      <p id="who"></p>
      <h2>Why</h2>
      <p id="why"></p>
    </div>
  </div>
  <pre class="codepen-js">
    $(document).ready(function(){
      var petitionSlug = 'turn-back-human-trafficking-faith-leaders';
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/petitions/'+petitionSlug+'.json',
        dataType: 'jsonp',
      })
      .done(function(data) {
        $('#title').html(data.title);
        $('#signature_count').html(data.signature_count);
        $('#creator_name').html(data.creator_name);
        $('#what').html(data.what);
        $('#who').html(data.who);
        $('#why').html(data.why);
        $('#js-content-wrapper').removeClass('hidden');
      });
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

          <h2 id="get-featured-petitions">Get featured petitions</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/petitions/featured.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above code would display your returned featured petitions data in the console.  The JSON would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_entries"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"release-pro-democracy-youth-activists-in-azerbaijan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Release pro-democracy youth activists in Azerbaijan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/release-pro-democracy-youth-activists-in-azerbaijan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"awesome"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/28870/hero/Screen_Shot_2014-11-14_at_3.57.21_PM.png?1415999011"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/28870/form/Screen_Shot_2014-11-14_at_3.57.21_PM.png?1415999011"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/28870/large/Screen_Shot_2014-11-14_at_3.57.21_PM.png?1415999011"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/28870/open_graph/Screen_Shot_2014-11-14_at_3.57.21_PM.png?1415999011"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/28870/original/Screen_Shot_2014-11-14_at_3.57.21_PM.png?1415999011"</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"President Ilham Aliyev of Azerbaijan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Immediately release the imprisoned youth activists from the NIDA civic movement.\r\n\r\nShahin Novruzlu, Rashadat Akundov, Mammad Azizov, Bakhtiyar Guliyev, Zaur Gurbanli, Rashad Hasanov, Uzeyir Mammadli and Ilkin Rustamzade were arrested on criminal charges of possessing explosives and intent of public disorder. Human rights organizations believe these charges have been fabricated. The actual reason for their arrest was their criticism of the Azerbaijani authorities and their online activism, calling for peaceful demonstrations.\r\n\r\nShahin Novruzlu, who was only 17 at the time of his arrest, has lost his front teeth as a result of torture in detention. Mammad Azizov and Bakhtiyar Guliyev have complained of torture too.\r\n\r\nFrom 14 May 2014, Azerbaijan is chairing the Committee of Ministers of the Council of Europe. This organization is responsible for promoting and protecting human rights. I am deeply concerned that there are civil society activists in Azerbaijan tortured and imprisoned solely for expressing their views and organizing peaceful protests.\r\n\r\nAzerbaijan must live up to the high expectations of the chair of the Committee of Ministers of the Council of Europe. The NIDA activists must be immediately released."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">119</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Kristyn Arrighi"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-24T20:07:14.607-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-26T14:30:57.330-05:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Shahin Novruzlu and fellow youth activists from the pro-democracy movement NIDA campaigned for democracy and against human rights abuses and widespread corruption in Azerbaijan. In February 2013 th..."</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"give-us-more-icecream"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Give us more icecream"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/give-us-more-icecream"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"awesome"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/139482/hero/10982478_634745530004482_279346285079955699_n.jpg?1455250695"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/139482/form/10982478_634745530004482_279346285079955699_n.jpg?1455250695"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/139482/large/10982478_634745530004482_279346285079955699_n.jpg?1455250695"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/139482/open_graph/10982478_634745530004482_279346285079955699_n.jpg?1455250695"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/139482/original/10982478_634745530004482_279346285079955699_n.jpg?1455250695"</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cook"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cook and provide more icecream"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tudor Bradatan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-11T23:17:42.782-05:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-26T14:20:46.987-05:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Because we like and need it"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cluj"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"46.7712101"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23.6236353"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RO"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CJ"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-02-11T23:17:42.769-05:00"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"turn-back-human-trafficking-faith-leaders"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Pledge to TURN BACK human trafficking Now - Faith or Community Leaders"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/turn-back-human-trafficking-faith-leaders"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"awesome"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/hero/Untitled.png?1433187465"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/form/Untitled.png?1433187465"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/large/Untitled.png?1433187465"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/open_graph/Untitled.png?1433187465"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/107370/original/Untitled.png?1433187465"</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"President John Dramani Mahama"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I know that globally millions of people are trafficked for forced labour and sexual exploitation and that Ghana is a source, transit and destination country for this social evil. The concerns raised by Parliament recently, about men, women, and children who are trafficked and subjected to forced labor and sexual exploitation human points to the need for everyone to take action.\r\n\r\nI hereby pledge to TURN BACK human trafficking. \r\n•\tI will be vigilant of suspicious movement of children and vulnerable people, victims of bonded labour and of children working when they should be in school \r\n•\tI promise to always report my concerns to the appropriate authorities as quickly as possible.\r\n\r\nAs a faith or community leader, I promise to warn my congregation of the dangers of child trafficking, and support them in reporting any suspicions they have."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Kristyn Arrighi"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-06-01T15:37:47.621-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-14T08:45:52.396-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Today there are over 192,000 people trapped in modern slavery in Ghana [1]. Denied of their rights to education and often lacking parental care or support, over 1.8 million Ghanaian children are wo..."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">//</span><span class="w"> </span><span class="err">...</span><span class="w">
</span><span class="p">],</span><span class="w">
</span><span class="nt">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/featured.json?page=1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/featured.json"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"prev"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/featured.json?page=2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/featured.json?page=3"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This retrieves a JSON object compliant with the <a href="http://jsonapi.org/">JSON API</a> specification, containing an array of featured petitions objects on its data property.</p>

<p><strong>Important Note:</strong> The previous featured petitions API endpoint at <code class="prettyprint">https://demo.controlshiftlabs.com/featured.json</code> (note the missing <code class="prettyprint">/petitions</code> path) is being deprecated and <strong>will be removed</strong> in the near future. Please use this new endpoint for retrieving featured petitions from now on.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://demo.controlshiftlabs.com/petitions/featured.json</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>locale</td>
<td>null</td>
<td>string - optional - Locale filter for petitions</td>
</tr>
</tbody></table>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io:</p>

<div class="js-codepen-data hidden" data-title="ControlShift Labs: Featured Petitions Example">
  <div class="codepen-html">
    <h1>Featured Petitions</h1>
    <ul id="featured-petitions">
    </ul>
  </div>
  <pre class="codepen-js">
    $(document).ready(function(){
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/petitions/featured.json',
        dataType: 'jsonp',
      })
      .done(function(resp) {
        var $placeholder = $('#featured-petitions');
        $.each(resp.data, function(index, petition){
          output = '<li>'
          output += '<h2><a href="'+petition.url+'">'+petition.title+'</a></h2>';
          output += '<h3>'+petition.signature_count+' signatures out of '+petition.goal+' needed </h3>';
          output += '<p>'+petition.why+'</p>';
          output += '<p><a href="'+petition.url+'">Learn More</a></p>';
          output += '</li>';
          $placeholder.append(output);
        });
      });
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

          <h2 id="get-list-of-categories">Get list of categories</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/categories.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above code would display a list of categories in the console.  The JSON would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"category_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Animal Rights"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"category_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"animal-rights-2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/categories/animal-rights-2.json"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locales"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"es"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Derechos Animales"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"category_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cats"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"category_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">31</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cats"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/categories/cats.json"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">270</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locales"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"es"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gatos"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"category_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Civil Rights"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"category_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"civil-rights-1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/categories/civil-rights-1.json"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">165</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locales"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"es"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Derechos Civiles"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"category_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Culture"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"category_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cultura"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/categories/cultura.json"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locales"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"es"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cultura"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This retrieves a JSON array of category objects.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://demo.controlshiftlabs.com/categories.json</code></p>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io:</p>

<div class="js-codepen-data hidden" data-title="ControlShift Labs: Categories List Example">
  <div class="codepen-html">
    <h1>Categories List</h1>
    <div id="categories">
    </div>
  </div>
  <pre class="codepen-js">
    $(document).ready(function(){
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/categories.json',
        dataType: 'jsonp',
      })
      .done(function(data) {
        var $placeholder = $('#categories');
        $.each(data, function(index, category){
          output = '<h2><a href="'+category.url+'">'+category.category_name+'</a></h2>';
          output += '<ul>'
          output += '<li><strong>Slug:</strong> '+category.slug+'</li>';
          output += '<li><strong>Signatures:</strong>'+category.signature_count+'</li>';
          output += '<li><strong>API URL:</strong>'+category.url+'</li>';
          output += '</ul><hr/>';
          $placeholder.append(output);
        });
      });
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

          <h2 id="list-petitions-in-a-category">List petitions in a category</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/categories/mice.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above code would return petitions data from the category with the slug <code class="prettyprint">mice</code>.  The JSON would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"previous_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mice"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apple-stop-your-comic-sans-snobbery"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apple: Stop your Comic Sans snobbery"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/apple-stop-your-comic-sans-snobbery"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"good"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/24551/hero/helveticacomicsans.gif?1398764339"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/24551/form/helveticacomicsans.gif?1398764339"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/24551/large/helveticacomicsans.gif?1398764339"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/24551/open_graph/helveticacomicsans.gif?1398764339"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/24551/original/helveticacomicsans.gif?1398764339"</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tim Cook, CEO Apple"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Use Comic Sans for the default font on the iPhone 6."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John Wood"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-04-29T05:35:47.693-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-06T11:02:17.617-05:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apple occupy a key position in the hearts of typeface poseurs everywhere. If they were to make a bold step and switch to using the people's font, Comic Sans on the new iPhone, this would cause mass..."</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"clean-up-the-himalayas"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Clean up the Himalayas"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/clean-up-the-himalayas"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"good"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/6359/hero/gorak_shep_thumb.jpg?1431734031"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/6359/form/gorak_shep_thumb.jpg?1431734031"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/6359/large/gorak_shep_thumb.jpg?1431734031"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/6359/open_graph/gorak_shep_thumb.jpg?1431734031"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/6359/original/gorak_shep_thumb.jpg?1431734031"</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nepal Ghurung"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Clean up the Khumbu region."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grant Cox"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-06-03T17:13:41.399-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-07-17T15:11:48.665-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It's quite dirty, and I don't like it."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nepal"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"28.394857"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"84.124008"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NP"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nt">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nepal"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-06-03T17:13:41.057-04:00"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>This retrieves a paginated list of petitions in a category.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://demo.controlshiftlabs.com/categories/&lt;category slug&gt;.json</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>category slug</td>
<td>null</td>
<td>string - required - submitted as a part of the endpoint path, not as a separate URL parameter</td>
</tr>
<tr>
<td>page</td>
<td>1</td>
<td>integer - optional - The page number of results for the specified category. Minimum of 1.</td>
</tr>
</tbody></table>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io:</p>

<div class="js-codepen-data hidden"  data-title="ControlShift Labs: List of Petitions in a Category Example">
  <div class="codepen-html">
    <h1>Petitions in category &ldquo;<span id="name"></span>&rdquo;</h1>
    <div id="petitions">
    </div>
  </div>
  <pre class="codepen-js">
    $(document).ready(function(){
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/categories/mice.json',
        dataType: 'jsonp',
      })
      .done(function(data) {
        // Populate global category data
        $('#name').text(data.name);

        // Populate petitions data
        var $placeholder = $('#petitions');
        $.each(data.results, function(index, petition){
          output = '<h2><a href="'+petition.url+'">'+petition.title+'</a></h2>';
          output += '<ul>';
          output += '<li><strong>Image:</strong> '+petition.image_url+'</li>';
          output += '<li><strong>Who:</strong> '+petition.who+'</li>';
          output += '<li><strong>What:</strong> '+petition.what+'</li>';
          output += '<li><strong>Why:</strong> '+petition.why+'</li>';
          output += '<li><strong>Signatures:</strong> '+petition.signature_count+'</li>';
          output += '<li><strong>URL:</strong> '+petition.url+'</li>';
          output += '</ul><hr/>';
          $placeholder.append(output);
        });
      });
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

          <h2 id="list-petitions-in-an-effort">List petitions in an effort</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">effortSlug</span> <span class="o">=</span> <span class="s1">'forecast-the-facts'</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/efforts/'</span><span class="o">+</span><span class="nx">effortSlug</span><span class="o">+</span><span class="s1">'.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above code would return petitions data from the effort with the slug <code class="prettyprint">forecast-the-facts</code>.  The JSON would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It is imperative that weather reporters fulfill an important part of their job, and explain the ways that climate change has influenced the freakish \"Frankenstorm\" Sandy. Below is a list of the meteorologists in your area, with telephone numbers and e-mail addresses. Please call or email them a message in your own words, asking them to connect the dots between global warming pollution and disasters like Sandy. Take a look at the talking points below if you need any help."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
  </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/efforts/images/16/hero/forecast.png?1351625402"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"petitions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts-of-frankenstorm-wmtv-madison-wi"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts of Frankenstorm: WMTV Madison, WI"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/forecast-the-facts-of-frankenstorm-wmtv-madison-wi"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"good"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/102705/hero/forecast.png?1429199472"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/102705/form/forecast.png?1429199472"</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/102705/large/forecast.png?1429199472"</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/102705/open_graph/forecast.png?1429199472"</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/102705/original/forecast.png?1429199472"</span><span class="w">
      </span><span class="p">}],</span><span class="w">
      </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WMTV Madison, WI"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It is imperative that weather reporters fulfill an important part of their job, and explain the ways that climate change has influenced the freakish \"Frankenstorm\" Sandy. Below is a list of the meteorologists in your area, with telephone numbers and e-mail addresses. Please call or email them a message in your own words, asking them to connect the dots between global warming pollution and disasters like Sandy. Take a look at the talking points below if you need any help."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Kristyn Arrighi"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-04-16T11:51:12.700-04:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T20:23:06.034-04:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"We want TV meteorologists to understand that the public is depending on them for information about climate change, especially as it increasingly impacts our weather patterns. We know that meteorolo..."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WMTV-TV (Madison), Forward Drive, Madison, WI, United States"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43.05091"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-89.486738"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forward Dr"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53711"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WI"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"street_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"615"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WMTV-TV (Madison)"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-04-16T11:51:11.222-04:00"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts-of-frankenstorm-woak"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts of Frankenstorm: WOAK"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://demo.controlshiftlabs.com/petitions/forecast-the-facts-of-frankenstorm-woak"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"good"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/115310/hero/forecast.png?1439846499"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/115310/form/forecast.png?1439846499"</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/115310/large/forecast.png?1439846499"</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/115310/open_graph/forecast.png?1439846499"</span><span class="w">
      </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/115310/original/forecast.png?1439846499"</span><span class="w">
      </span><span class="p">}],</span><span class="w">
      </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WOAK"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It is imperative that weather reporters fulfill an important part of their job, and explain the ways that climate change has influenced the freakish \"Frankenstorm\" Sandy. Below is a list of the meteorologists in your area, with telephone numbers and e-mail addresses. Please call or email them a message in your own words, asking them to connect the dots between global warming pollution and disasters like Sandy. Take a look at the talking points below if you need any help."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"creator_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Adam Klaus"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-17T17:21:39.791-04:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-17T17:29:02.816-04:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"We want TV meteorologists to understand that the public is depending on them for information about climate change, especially as it increasingly impacts our weather patterns. We know that meteorolo..."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"query"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Oklahoma City, OK, United States"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35.4675602"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-97.5164276"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"postal_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"region"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OK"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"street_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"venue"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2013-12-17T14:49:51.324-05:00"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This retrieves a list of petitions in an effort.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://demo.controlshiftlabs.com/efforts/&lt;effort slug&gt;.json</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>effort slug</td>
<td>null</td>
<td>string - required - submitted as a part of the endpoint path, not as a separate URL parameter</td>
</tr>
</tbody></table>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io:</p>

<div class="js-codepen-data hidden" data-title="ControlShift Labs: List of Petitions in an Effort Example">
  <div class="codepen-html">
    <h1>Petitions in effort &ldquo;<span id="title"></span>&rdquo;</h1>
    <p><span id="description"></span></h1>
    <div id="petitions">
    </div>
  </div>
  <pre class="codepen-js">
    $(document).ready(function(){
      var effortSlug = 'forecast-the-facts';
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/efforts/'+effortSlug+'.json',
        dataType: 'jsonp',
      })
      .done(function(data) {
        // Populate global effort data
        $('#title').text(data.title);
        $('#description').text(data.description);

        // Populate petitions data
        var $placeholder = $('#petitions');
        $.each(data.petitions, function(index, petition){
          output = '<h2><a href="'+petition.url+'">'+petition.title+'</a></h2>';
          output += '<ul>';
          output += '<li><strong>Image:</strong> '+petition.image_url+'</li>';
          output += '<li><strong>Who:</strong> '+petition.who+'</li>';
          output += '<li><strong>What:</strong> '+petition.what+'</li>';
          output += '<li><strong>Why:</strong> '+petition.why+'</li>';
          output += '<li><strong>Signatures:</strong> '+petition.signature_count+'</li>';
          output += '<li><strong>Goal:</strong> '+petition.goal+'</li>';
          output += '<li><strong>URL:</strong> '+petition.url+'</li>';
          output += '<li><strong>Location:</strong> <ul>'
          output += '<li><strong>Query:</strong> '+petition.location.query+'</li>';
          output += '<li><strong>Latitude:</strong> '+petition.location.latitude+'</li>';
          output += '<li><strong>Longitude:</strong> '+petition.location.longitude+'</li>';
          output += '</ul></li>';
          output += '</ul><hr/>';
          $placeholder.append(output);
        });
      });
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

          <h2 id="find-near-by-petitions">Find near by petitions</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">effortSlug</span> <span class="o">=</span> <span class="s1">'forecast-the-facts'</span><span class="p">,</span>
    <span class="nx">latitude</span> <span class="o">=</span> <span class="mf">38.88233400000001</span><span class="p">,</span>
    <span class="nx">longitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">77.17109140000002</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/efforts/'</span><span class="o">+</span><span class="nx">effortSlug</span><span class="o">+</span><span class="s1">'/'</span><span class="o">+</span><span class="s1">'near.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">'location[latitude]'</span><span class="p">:</span> <span class="nx">latitude</span><span class="p">,</span>
      <span class="s1">'location[longitude]'</span><span class="p">:</span> <span class="nx">longitude</span>
    <span class="p">}</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span> <span class="nx">data</span> <span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<!--slash in '/'+'near.json' above disappears if combined with near-->

<blockquote>
<p>The above code would return petitions data from the effort with the slug <code class="prettyprint">forecast-the-facts</code>.  The JSON would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"closest_target"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"doug-kammerer-nbc4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doug Kammerer - NBC4"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Washington D.C., DC"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_petition_created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts-of-frankenstorm-doug-kammerer-nbc4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts of Frankenstorm: Doug Kammerer - NBC4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/forecast-the-facts-of-frankenstorm-doug-kammerer-nbc4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/2139/hero/forecast.png?1351625677"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Doug Kammerer - NBC4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"other_targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"linda-church-wpix"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Linda Church - WPIX"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New York, NY"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_petition_created"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts-of-frankenstorm-linda-church-wpix"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts of Frankenstorm: Linda Church - WPIX"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/forecast-the-facts-of-frankenstorm-linda-church-wpix"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/2137/hero/forecast.png?1351625520"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Linda Church - WPIX"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wnyc"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WNYC "</span><span class="p">,</span><span class="w">
      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Manhattan, New York, NY, United States"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_awaiting_petition"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"create_petition_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/efforts/forecast-the-facts/petitions/creating?target_id=5148"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"whdtv-boston"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WHDTV Boston"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Boston, MA, United States"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_petition_created"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts-of-frankenstorm-whdtv-boston"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts of Frankenstorm: WHDTV Boston"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/forecast-the-facts-of-frankenstorm-whdtv-boston"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/28044/hero/forecast.png?1405015225"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WHDTV Boston"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wmtv-madison-wi"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WMTV Madison, WI"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WMTV-TV (Madison), Forward Drive, Madison, WI, United States"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_petition_created"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forecast-the-facts-of-frankenstorm-wmtv-madison-wi"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Forecast the Facts of Frankenstorm: WMTV Madison, WI"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/forecast-the-facts-of-frankenstorm-wmtv-madison-wi"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d8s293fyljwh4.cloudfront.net/petitions/images/102705/hero/forecast.png?1429199472"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WMTV Madison, WI"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
        </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Search for closest petition in an effort</p>

<p>This JSON endpoint allows you to reproduce the &ldquo;search for the nearest petition in an effort&rdquo; interface. Use this endpoint to build a place for users to enter their location. Once they&rsquo;ve searched for a location, we&rsquo;ll return the nearest petition. This endpoint can most easily be used with a <a href="https://developers.google.com/places/web-service/autocomplete">Google Maps</a> integration to help your users locate their addresses or other points of interest. For an example, click on the working example below.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET https://demo.controlshiftlabs.com/efforts/&lt;effort slug&gt;/near.json</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>This endpoints accepts a few nested attributes in a <code class="prettyprint">location</code> object, as described below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>effort slug</td>
<td>null</td>
<td>string - required - submitted as a part of the endpoint path, not as a separate URL parameter</td>
</tr>
<tr>
<td>location[latitude]</td>
<td>null</td>
<td>float - required - a float representing the queried latitude</td>
</tr>
<tr>
<td>location[longitude]</td>
<td>null</td>
<td>float - required - a float representing the queried longitude</td>
</tr>
<tr>
<td>location[country]</td>
<td>null</td>
<td>string - optional - for efforts configured to use the &ldquo;by country&rdquo; search strategy, you can pass in the target country as a two letter <a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2#Officially_assigned_code_elements">ISO 3166-1</a> code.</td>
</tr>
<tr>
<td>location[region]</td>
<td>null</td>
<td>string - optional - for efforts configured to use the &ldquo;by state&rdquo; search strategy, you can pass in the target state as a two letter state abbreviation.</td>
</tr>
</tbody></table>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io:</p>

<div class="js-codepen-data hidden"
  data-js_external="https://maps.googleapis.com/maps/api/js?key=AIzaSyAm5aA1UDKBL6dRD9yHPGydlZcBgzk6lsY&libraries=places"
  data-title="ControlShift Labs: List of Petitions in an Effort Example">
  <div class="codepen-html">
    <h1>Find the closest petitions to you</h1>
    <form>
      <input type="text" class="form-control" id="effort-lookup-input" placeholder="Enter your address or a nearby landmark">
      <small>Note: The above text field is auto-completed using the Google Maps <a href="https://developers.google.com/places/web-service/autocomplete" target="_blank">Autocomplete API</a></small>
    </form>
    <div id="petitions">
    </div>
  </div>
  <pre class="codepen-js">
    function buildPetition(target, description){
      output = '<h2><em>'+description+' Petition</em>: '+target.name+'</h2>';
      output += '<h3>'+target.location+'</h3> <ul>';
      output += '<li><strong>Title:</strong> '+target.petition.title+'</li>';
      output += '<li><strong>Who:</strong> '+target.petition.who+'</li>';
      output += '<li><strong>Goal:</strong> '+target.petition.goal+'</li>';
      output += '<li><strong>Signatures so far:</strong> '+target.petition.signature_count+'</li>';
      output += '</ul><hr/>';
      return output;
    }

    function getPetitionsCallback(place) {
      // Get the place details from the autocomplete object.
      var place = autocomplete.getPlace();

      // get the targets and petitions (if they exist) for the effort near the place specified.
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/efforts/forecast-the-facts/near.json',
        dataType: 'jsonp',
        data: {
          'location[latitude]': place.geometry.location.lat(),
          'location[longitude]': place.geometry.location.lng()
        }
      })
      .done(function(data) {
        $placeholder = $('#petitions');
        if (data.code != undefined) {
          if ((data.code == 'no_nearby_targets') || (data.code == 'no_nearby_petitions')){
            $placeholder.html('<h2>No Petitions Found</h2>');
            return;
          } else if (data.code == 'location_required') {
            $placeholder.html('<h2>Location required</h2>');
            return;
          }
        }
        //populate closest target
        $placeholder.html( buildPetition(data.closest_target, 'Closest') );
        $.each(data.other_targets, function(index, other_petition){
          $placeholder.append( buildPetition(other_petition, 'Near By') );
        });
      });
    };

    $(document).ready(function(){
      $('form').on('submit', function(e){e.preventDefault()});
      var input = document.getElementById('effort-lookup-input');
      var options = { };
      autocomplete = new google.maps.places.Autocomplete(input, options);
      autocomplete.addListener('place_changed', getPetitionsCallback);
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

          <h2 id="logged-in-user">Logged in user</h2>
<pre class="highlight javascript"><code><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s1">'https://demo.controlshiftlabs.com/api/graph/me.json'</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s1">'jsonp'</span><span class="p">,</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre>

<blockquote>
<p>The above code would user details for a signed in user. The returned JSON would be structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"authenticated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"me"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="s2">"john@smith.com"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"petitions"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
       </span><span class="nt">"slug"</span><span class="p">:</span><span class="s2">"sample-campaign"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Sample Campaign"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"created_at"</span><span class="p">:</span><span class="s2">"2016-03-25T15:37:28.849-04:00"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="s2">"2016-03-25T15:37:35.304-04:00"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"events"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
       </span><span class="nt">"slug"</span><span class="p">:</span><span class="s2">"sample-campaign"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"title"</span><span class="p">:</span><span class="s2">"Sample Campaign"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"created_at"</span><span class="p">:</span><span class="s2">"2016-03-25T15:37:28.849-04:00"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="s2">"2016-03-25T15:37:35.304-04:00"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"chapters"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
       </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Brooklyn bruisers"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"slug"</span><span class="p">:</span><span class="s2">"brooklyn-bruisers"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"created_at"</span><span class="p">:</span><span class="s2">"2015-05-14T15:53:03.901-04:00"</span><span class="p">,</span><span class="w">
       </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="s2">"2016-03-25T15:40:44.661-04:00"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response for a visitor who is not logged in:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"not_authenticated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="s2">"user is not signed in"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response for a hostname that is not whitelisted:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"error"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"field"</span><span class="p">:</span><span class="s2">"referer"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"messages"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"host name not whitelisted"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>We provide a specialized jsonp endpoint to return information about the currently signed in user. Customers can use this endpoint to power features where information about the current user&rsquo;s petitions, sign in status, and other information about their account is displayed on external sites. Some examples of the sorts of functionality that this could be used to provide include:</p>

<ul>
<li>Conditionally show either a login link for unauthenticated users or a link to the user&rsquo;s my account page in the header of external pages.</li>
<li>Show information about a user&rsquo;s campaigns when someone visits an external site, or a prompt to start a campaign if the currently signed in user has none.</li>
<li>Show a direct link to a user&rsquo;s local group from an external site rather than linking to a generic search for your group page.</li>
</ul>

<aside class="notice">
You must whitelist your hostname prior to using this end point. Read more below.
</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://demo.controlshiftlabs.com/api/graph/me.json</code></p>

<h3 id="working-example">Working Example</h3>

<p>View and edit a working example on codepen.io.  Note: codepen.io is <em>whitelisted</em> for the demo account.</p>

<div class="js-codepen-data hidden" data-title="ControlShift Labs: Logged in User Example">
  <div class="codepen-html">
    <h1>Logged in User</h1>
    <p class="js-not-logged-in hidden">The user is not logged in.</p>
    <ul class="js-logged-in hidden">
      <li><strong>First Name:</strong> <span id="first_name"></span></li>
      <li><strong>First Name:</strong> <span id="last_name"></span></li>
      <li><strong>Email:</strong> <span id="email"></span></li>
      <li><strong>Petitions:</strong> <ul id="petitions"></ul></li>
      <li><strong>Events:</strong> <ul id="events"></ul></li>
      <li><strong>Chapters:</strong> <ul id="chapters"></ul></li>
    </ul>
  </div>
  <pre class="codepen-js">
    $(document).ready(function(){
      $.ajax({
        url: 'https://demo.controlshiftlabs.com/api/graph/me.json',
        dataType: 'jsonp',
      })
      .done(function(data) {
        if(data.status == 'authenticated'){
          // Populate data for logged in user
          $('#first_name').html(data.me.first_name);
          $('#last_name').html(data.me.last_name);
          $('#email').html(data.me.email);

          var $petitionsPlaceholder = $('#petitions');
          $.each(data.petitions, function(index, petition){
            $petitionsPlaceholder.append('<li>'+petition.title+'</li>');
          });

          var $eventsPlaceholder = $('#events');
          $.each(data.events, function(index, event){
            $eventsPlaceholder.append('<li>'+event.title+'</li>');
          });

          var $chaptersPlaceholder = $('#chapters');
          $.each(data.chapters, function(index, chapter){
            $chaptersPlaceholder.append('<li>'+chapter.name+'</li>');
          });

          $('.js-logged-in').removeClass('hidden');
        }else if(data.status == 'not_authenticated'){
          // Show "not logged in" for users who aren't logged in
          $('.js-not-logged-in').removeClass('hidden');
        }else if(data.status == 'error'){
          // Show known error messages
          $('body').append('<h2>Errors</h2><ul>')
          $.each(data.errors, function(index, error){
            $('body').append('<li><strong>'+error.field+'</strong> '+error.messages.join('; ')+'</li>')
          });
          $('body').append('</ul>')
        }
      });
    })
    .error(function(data){
      $('body').append('<h2>Errors</h2><p>Unknown Error</p>');
    });
  </pre>
</div>

<form action="https://codepen.io/pen/define" method="POST" target="_blank" class="hidden">
  <input type="hidden" name="data" class="js-data" value="">
  <input type="submit" value="Launch Example on CodePen">
</form>

<h3 id="whitelisting-a-hostname">Whitelisting a Hostname</h3>

<p>We authenticate requests to the current user endpoint by validating the hostname set in the HTTP referrer header against a whitelist. The whitelist is set of hostnames that scripts can be served from. If you request the endpoint from a script served from a non-whitelisted hostname you&rsquo;ll get an error message. This is necessary to prevent cross site scripting attacks that would allow someone to display logged in user information on unauthorized sites.</p>

<p>You can add hostnames to the whitelist through a self-serve interface in the &ldquo;Settings&rdquo; area of your instance. Settings &gt; Add Hostname &gt; enter a Hostname, and click save.</p>

<p>The hostname must be a hostname string like &ldquo;localhost&rdquo; &ldquo;www.google.com&rdquo; or the like. Wildcards or full HTTP URLs are not supported.</p>

<p>When you access the graph API endpoint from a page served from a whitelisted hostname the browser will automatically set a referrer header on those requests. We use this referrer header to validate the server the script was served from against the whitelist. You can verify that a whitelisted hostname is working properly with the curl command line tool:</p>

<p><code class="prettyprint">curl --referer http://localhost/ http://demo.controlshiftlabs.com/api/graph/me.json</code></p>

<p>The above should return a JSON blob indicating that the user is not signed in if localhost is whitelisted. Otherwise you&rsquo;ll get a not whitelisted error.</p>

<p>For authenticated users we currently return their first and last names, email addresses, and lists of petitions they&rsquo;ve created, events they&rsquo;ve created and local groups they are a member of.</p>

          <h1 id="webhook-endpoints">Webhook Endpoints</h1>

<p>Webhooks can be used by software engineers to integrate ControlShift with third-party systems. They allow engineers to build software that is triggered by events that take place within ControlShift. ControlShift would execute HTTP calls when certain event happen (e.g. a petition is launched; a category is changed).</p>

<p>To begin using these new webhooks, go to the admin homepage and click &ldquo;Settings&rdquo; under &ldquo;Manage.&rdquo; Then choose the &ldquo;CRM Integration &amp; Webhooks&rdquo; tab and click &ldquo;Configure Webhook Endpoints.&rdquo; To begin sending data, you&rsquo;ll need to add a &ldquo;New Webhook Endpoint.&rdquo; Each Webhook Endpoint URL receives a full firehose of all hooks that occur within ControlShift.</p>

<p>We recommend using a tool like <a href="http://requestb.in/">RequestBin</a> to help debug and develop your webhook integration. RequestBin allows engineers to see all of the webhooks generated by the application and sent to an endpoint.</p>

<p>If you need additional information about webhooks or how to use them, please send us a support email <a href="mailto:support@controlshiftlabs.com">support@controlshiftlabs.com</a>. We&rsquo;d also love stories about how customers are using webhooks.</p>

<h3 id="retries">Retries</h3>

<p>For webhook notifications successfully processed the response should have an HTTP 2XX status code. Responses returning a different status code will be marked as failed and automatically retried up to 9 times with an exponential backoff (e.g.: after 15s, 30s, 90s, etc.).</p>

<p>If after 9 retries the notification cannot be delivered, the webhook endpoint will be automatically disabled and will need to be re-enabled from the admin page to start receiving webhook notifications again.</p>

<h2 id="webhook-types-summary">Webhook types summary</h2>

<p>You can configure ControlShift Labs Webhooks to return the following event types:</p>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><a href="#blast_email-created">blast_email.created</a></td>
<td>A new blast email is ready for moderation</td>
</tr>
<tr>
<td><a href="#category-created">category.created</a></td>
<td>A new category is created</td>
</tr>
<tr>
<td><a href="#category-updated">category.updated</a></td>
<td>A category is changed</td>
</tr>
<tr>
<td><a href="#category-deleted">category.deleted</a></td>
<td>A category has been deleted and removed from the organisation</td>
</tr>
<tr>
<td><a href="#data-full_table_exported">data.full_table_exported</a></td>
<td>A full-table dump is ready for retrieval at S3</td>
</tr>
<tr>
<td><a href="#data-incremental_table_exported">data.incremental_table_exported</a></td>
<td>An incremental CSV update is ready for retrieval at S3</td>
</tr>
<tr>
<td><a href="#event-created">event.created</a></td>
<td>A new event is published</td>
</tr>
<tr>
<td><a href="#event-updated">event.updated</a></td>
<td>An event is updated</td>
</tr>
<tr>
<td><a href="#attendee-created">attendee.created</a></td>
<td>Member RSVP to event</td>
</tr>
<tr>
<td><a href="#attendee-updated">attendee.updated</a></td>
<td>Member updates RSVP to event</td>
</tr>
<tr>
<td><a href="#attendee-deleted">attendee.deleted</a></td>
<td>Attendee permanently deleted. This is currently only triggered when a member deletes its account.</td>
</tr>
<tr>
<td><a href="#flag-created">flag.created</a></td>
<td>Someone flags a problem for admin attention</td>
</tr>
<tr>
<td><a href="#local_chapter-last_organiser-deleted">local_chapter.last_organiser.deleted</a></td>
<td>A local chapter&rsquo;s last organiser leaves the group</td>
</tr>
<tr>
<td><a href="#local_chapter-organiser_request-created">local_chapter.organiser_request.created</a></td>
<td>A user applies to be a local chapter organiser</td>
</tr>
<tr>
<td><a href="#member-deleted">member.deleted</a></td>
<td>A member is deleted</td>
</tr>
<tr>
<td><a href="#member-deleted-resources_transferred">member.deleted.resources_transferred</a></td>
<td>Resources previously owned by a deleted member have been transferred to another</td>
</tr>
<tr>
<td><a href="#petition-flagged">petition.flagged</a></td>
<td>A petition is flagged for the first or fifth time</td>
</tr>
<tr>
<td><a href="#petition-inappropriate-creator_message">petition.inappropriate.creator_message</a></td>
<td>An inappropriate petition&rsquo;s creator writes a message to admins</td>
</tr>
<tr>
<td><a href="#petition-launched">petition.launched</a></td>
<td>A new petition is launched</td>
</tr>
<tr>
<td><a href="#petition-launched-ham">petition.launched.ham</a></td>
<td>A petition passes the post-launch spam check</td>
</tr>
<tr>
<td><a href="#petition-launched-requires_moderation">petition.launched.requires_moderation</a></td>
<td>A new petition requires moderation</td>
</tr>
<tr>
<td><a href="#petition-reactivated">petition.reactivated</a></td>
<td>A hidden or ended petition is reactivated</td>
</tr>
<tr>
<td><a href="#petition-updated">petition.updated</a></td>
<td>A petition is updated</td>
</tr>
<tr>
<td><a href="#petition-updated-requires_moderation">petition.updated.requires_moderation</a></td>
<td>An updated petition requires moderation</td>
</tr>
<tr>
<td><a href="#petition-target-response">petition.target.response</a></td>
<td>Decision maker responded to a petition notification</td>
</tr>
<tr>
<td><a href="#user-created">user.created</a></td>
<td>New user created.</td>
</tr>
<tr>
<td><a href="#user-confirmed">user.confirmed</a></td>
<td>User has confirmed its new account. This event is only emitted for organisations who have user confirmation turned on.</td>
</tr>
<tr>
<td><a href="#user-changed">user.changed</a></td>
<td>A user has changed their saved first_name, last_name, postcode or locale.</td>
</tr>
<tr>
<td><a href="#signature-created">signature.created</a></td>
<td>Member signs a petition</td>
</tr>
<tr>
<td><a href="#signature-deleted">signature.deleted</a></td>
<td>Signature permanently deleted. Signature deletions are distinct from unsubscribes and should be treated as if the signature never happened</td>
</tr>
<tr>
<td><a href="#signature-confirmed">signature.confirmed</a></td>
<td></td>
</tr>
<tr>
<td><a href="#unsubscribe-created">unsubscribe.created</a></td>
<td>Member unsubscribes. This notification is emitted when member: is globally unsubscribed from the organisation by an admin or through the API, unsubscribes from partnership or unsubscribes from a petition.</td>
</tr>
<tr>
<td><a href="#locale-created">locale.created</a></td>
<td>New i18n instance created</td>
</tr>
<tr>
<td><a href="#forum-message-requires_moderation">forum.message.requires_moderation</a></td>
<td>A new message requires moderation</td>
</tr>
</tbody></table>

<h2 id="blast_email-created">blast_email.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">blast_email.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"blast_email.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"from_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane Doe"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"from_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please help spread the word"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"recipient_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">990</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A new blast email is ready for moderation</p>

<h2 id="category-created">category.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">category.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"category.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Environment"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"environment"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df67126973794c2efde76cc4"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A new category is created</p>

<h2 id="category-updated">category.updated</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">category.updated</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"category.updated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Environment"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"environment"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df67126973794c2efde76cc4"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A category is changed</p>

<h2 id="category-deleted">category.deleted</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">category.deleted</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"category.deleted"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Environment"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"environment"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"external_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df67126973794c2efde76cc4"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A category has been deleted and removed from the organisation</p>

<h2 id="data-full_table_exported">data.full_table_exported</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">data.full_table_exported</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data.full_table_exported"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://agra-data-exports.s3.amazonaws.com/default/petitions_20150803180434.csv?AWSAccessKeyId=XXX&amp;Expires=1438711490&amp;Signature=ABCDE%3D"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petitions"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cf0f50d7d225e20a188be328"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A full-table dump is ready for retrieval at S3</p>

<p><p>
<b>Note</b>
URL is encoded using (7-bit) ASCII and some characters will be escaped (i.e.: &rsquo;&amp;&rsquo;, &rsquo;&lt;&rsquo;, &rsquo;&gt;&rsquo;, etc.). See <a target="blank" href="http://www.rubydoc.info/gems/activesupport/3.2.22/ActiveSupport/JSON/Encoding">http://www.rubydoc.info/gems/activesupport/3.2.22/ActiveSupport/JSON/Encoding</a> for more details
</p></p>

<h2 id="data-incremental_table_exported">data.incremental_table_exported</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">data.incremental_table_exported</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data.incremental_table_exported"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://agra-data-exports.s3.amazonaws.com/default/petitions_20150803180434.csv?AWSAccessKeyId=XXX&amp;Expires=1438711490&amp;Signature=ABCDE%3D"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"table"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petitions"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cf0f50d7d225e20a188be328"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>An incremental CSV update is ready for retrieval at S3</p>

<p><p>
<b>Note</b>
URL is encoded using (7-bit) ASCII and some characters will be escaped (i.e.: &rsquo;&amp;&rsquo;, &rsquo;&lt;&rsquo;, &rsquo;&gt;&rsquo;, etc.). See <a target="blank" href="http://www.rubydoc.info/gems/activesupport/3.2.22/ActiveSupport/JSON/Encoding">http://www.rubydoc.info/gems/activesupport/3.2.22/ActiveSupport/JSON/Encoding</a> for more details
</p></p>

<h2 id="event-created">event.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">event.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"event.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition-hand-in"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Petition Hand In"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/events/petition-hand-in"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A new event is published</p>

<h2 id="event-updated">event.updated</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">event.updated</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"event.updated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition-hand-in"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Petition Hand In"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/events/petition-hand-in"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>An event is updated</p>

<h2 id="attendee-created">attendee.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">attendee.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attendee.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attending_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attending"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_group"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">747</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost/events/meetup-at-park"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"meetup-at-park"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Member RSVP to event</p>

<h2 id="attendee-updated">attendee.updated</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">attendee.updated</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attendee.updated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attending_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attending"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_group"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">747</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost/events/meetup-at-park"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"meetup-at-park"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Member updates RSVP to event</p>

<h2 id="attendee-deleted">attendee.deleted</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">attendee.deleted</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attendee.deleted"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attending_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attending"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_group"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">747</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost/events/meetup-at-park"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"meetup-at-park"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Attendee permanently deleted. This is currently only triggered when a member deletes its account.</p>

<h2 id="flag-created">flag.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">flag.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flag.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
    </span><span class="nt">"flagged"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ForumMessage"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">224</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"flagged_by"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bobby@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bobby Singer"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This violates our community commitments"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unreviewed"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-05T13:17:46-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-05T13:17:46-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f848f4b38b9125f7089d59ad"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Someone flags a problem for admin attention</p>

<p><p>For example, a local chapter organiser flags a forum message.</p></p>

<h2 id="local_chapter-last_organiser-deleted">local_chapter.last_organiser.deleted</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">local_chapter.last_organiser.deleted</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local_chapter.last_organiser.deleted"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"springfield-members"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Springfield Members"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/local_chapters/springfield-members"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A local chapter&rsquo;s last organiser leaves the group</p>

<h2 id="local_chapter-organiser_request-created">local_chapter.organiser_request.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">local_chapter.organiser_request.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local_chapter.organiser_request.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w">
    </span><span class="nt">"local_chapter"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"springfield-members"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Springfield Members"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/local_chapters/springfield-members"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">505</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane Goodall"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jane"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goodall"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I want to be part of this amazing group"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A user applies to be a local chapter organiser</p>

<h2 id="member-deleted">member.deleted</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">member.deleted</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member.deleted"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@example.com"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"new_owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">888</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"richard@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Richard Chamberlain"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Richard"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chamberlain"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A member is deleted</p>

<h2 id="member-deleted-resources_transferred">member.deleted.resources_transferred</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">member.deleted.resources_transferred</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member.deleted.resources_transferred"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@example.com"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"new_owner"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">888</span><span class="p">,</span><span class="w">
        </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"richard@example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Richard Chamberlain"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Richard"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chamberlain"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Resources previously owned by a deleted member have been transferred to another</p>

<h2 id="petition-flagged">petition.flagged</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.flagged</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.flagged"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A petition is flagged for the first or fifth time</p>

<h2 id="petition-inappropriate-creator_message">petition.inappropriate.creator_message</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.inappropriate.creator_message</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.inappropriate.creator_message"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>An inappropriate petition&rsquo;s creator writes a message to admins</p>

<h2 id="petition-launched">petition.launched</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.launched</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.launched"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A new petition is launched</p>

<h2 id="petition-launched-ham">petition.launched.ham</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.launched.ham</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.launched.ham"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A petition passes the post-launch spam check</p>

<h2 id="petition-launched-requires_moderation">petition.launched.requires_moderation</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.launched.requires_moderation</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.launched.requires_moderation"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A new petition requires moderation</p>

<h2 id="petition-reactivated">petition.reactivated</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.reactivated</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.reactivated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A hidden or ended petition is reactivated</p>

<h2 id="petition-updated">petition.updated</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.updated</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.updated"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A petition is updated</p>

<h2 id="petition-updated-requires_moderation">petition.updated.requires_moderation</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.updated.requires_moderation</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.updated.requires_moderation"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>An updated petition requires moderation</p>

<h2 id="petition-target-response">petition.target.response</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">petition.target.response</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"petition.target.response"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Don't destroy our park!"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://demo.controlshiftlabs.com/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/hero/imag0945.jpg?1438621934"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_image_sizes_url"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"form"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/form/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"large"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/large/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"open_graph"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/open_graph/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"style"</span><span class="p">:</span><span class="w"> </span><span class="s2">"original"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://d34smfggpfnvat.cloudfront.net/petitions/images/788/original/imag0945.jpg?1438621934"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Anytown City Council"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The park on Main Street is an important community space.  Don't approve the proposal to sell it to office building developers."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"goal"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agra.user.adm@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"full_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tyshawn"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Morissette"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12345-1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"34058-2356"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:11:02-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:12:15-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Studies have shown that green space is important to child development and community well-being."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9fccc1957d7d7ebc93fb0f05"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Decision maker responded to a petition notification</p>

<h2 id="user-created">user.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">user.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fullname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123-456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"101010"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>New user created.</p>

<h2 id="user-confirmed">user.confirmed</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">user.confirmed</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user.confirmed"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fullname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123-456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"101010"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>User has confirmed its new account. This event is only emitted for organisations who have user confirmation turned on.</p>

<h2 id="user-changed">user.changed</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">user.changed</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user.changed"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"changes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"Nate"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Nathan"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A user has changed their saved first_name, last_name, postcode or locale.</p>

<h2 id="signature-created">signature.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">signature.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signature.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country_without_fallback"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_group"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2919ec5f25d493c19690a21135d7fd902a336927"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/43.0.2357.130 Chrome/43.0.2357.130 Safari/537.36"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"daisy_chain_used"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"from_embed"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">747</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ebf2eb10c3d8939f42dff68"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Member signs a petition</p>

<p><p>We also include optional partnership or effort slugs nested under the petition resource for signatures that take place on petitions associated with those objects.</p></p>

<h2 id="signature-deleted">signature.deleted</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">signature.deleted</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signature.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country_without_fallback"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_group"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2919ec5f25d493c19690a21135d7fd902a336927"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/43.0.2357.130 Chrome/43.0.2357.130 Safari/537.36"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"daisy_chain_used"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"from_embed"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">747</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ebf2eb10c3d8939f42dff68"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Signature permanently deleted. Signature deletions are distinct from unsubscribes and should be treated as if the signature never happened</p>

<p><p>We also include optional partnership or effort slugs nested under the petition resource for signatures that take place on petitions associated with those objects.</p></p>

<h2 id="signature-confirmed">signature.confirmed</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">signature.confirmed</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signature.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">645</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jennifer"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Goines"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jenny@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone_number"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"postcode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23456"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"country_without_fallback"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"join_group"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"locale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2919ec5f25d493c19690a21135d7fd902a336927"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"bucket"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"127.0.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/43.0.2357.130 Chrome/43.0.2357.130 Safari/537.36"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"daisy_chain_used"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"from_embed"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"confirmed_reason"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_signed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"additional_fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">747</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost/petitions/don-t-destroy-our-park"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"don-t-destroy-our-park"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:30:01-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ebf2eb10c3d8939f42dff68"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p><p>We also include optional partnership or effort slugs nested under the petition resource for signatures that take place on petitions associated with those objects.</p></p>

<h2 id="unsubscribe-created">unsubscribe.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">unsubscribe.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unsubscribe.created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"river@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unsubscribe_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unsubscribable_type"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:38:49-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unsubscribe.created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"river@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unsubscribe_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unsubscribable_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GroupSubscription"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:38:49-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unsubscribe.created"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"river@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unsubscribe_organisation"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unsubscribable_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Signature"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T13:38:49-04:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"blast_email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">199</span><span class="p">,</span><span class="w">
        </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please help spread the word"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"030ee43a4fa9788e084d9cfc"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Member unsubscribes. This notification is emitted when member: is globally unsubscribed from the organisation by an admin or through the API, unsubscribes from partnership or unsubscribes from a petition.</p>

<p><p>
First example: Admin globally unsubscribes a member from the member page
</p>
<p>
Second example: Member unsubscribes from partnership
<br>
<span>
<strong>Note:</strong>
<strong>unsubscribe_organisation</strong>
can have true or false values depending on member&rsquo;s input at the unsubscribe page (only if the
<em>Allow global unsubscribes</em>
option is enabled for the organisation)
</span>
</p>
<p>
Third example: Member unsubscribes from petition
<br>
<span>
<strong>Notes:</strong>
<br>
<strong>unsubscribe_organisation</strong>
can have true or false values depending on member&rsquo;s input at the unsubscribe page (only if the
<em>Allow global unsubscribes</em>
option is enabled for the organisation)
<br>
The
<strong>blast_email</strong>
property will only be included if member unsubscribed by clicking on the link included on the petition blast email&rsquo;s footer
</span>
</p></p>

<h2 id="locale-created">locale.created</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">locale.created</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"locale.created"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"es"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"action_kit_external_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-03T12:38:46-04:00"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"df67126973794c2efde76cc4"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>New i18n instance created</p>

<h2 id="forum-message-requires_moderation">forum.message.requires_moderation</h2>

<blockquote>
<p>Example payload for <code class="prettyprint">forum.message.requires_moderation</code>:</p>
</blockquote>
<pre class="highlight json"><code><span class="w">  </span><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"forum.message.requires_moderation"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"thread_title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello everyone"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"I just wanted to say hi"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"admin_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unreviewed"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-05T13:17:46-04:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10829</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-05T13:17:46-04:00"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"discussable"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"discussable_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LocalChapter"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discussable_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">56</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"jid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f848f4b38b9125f7089d59ad"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A new message requires moderation</p>

<p><div class='mt10'>
<b>Note</b>
<div>
The <strong>admin_status</strong> field can take any of the following values:
<ul>
<li>
<em>unreviewed</em>
</li>
<li>
<em>flagged</em>
</li>
<li>
<em>approved_automatically</em>
</li>
<li>
<em>approved_manually</em>
</li>
<li>
<em>flagged_deleted</em>
</li>
<li>
<em>inappropriate</em>
</li>
</ul>
Though on the <em>forum.message.requires_moderation</em> notification type it will always be set to <em>unreviewed</em>
</div>
<div class='mt5'>
The <strong>discussable.discussable_type</strong> field can take any of the following values:
<ul>
<li>
<em>LocalChapter</em>
</li>
<li>
<em>Event</em>
</li>
<li>
<em>CalendarEvent</em>
</li>
<li>
<em>LocalChapterEvent</em>
</li>
<li>
<em>PetitionEvent</em>
</li>
</ul>
</div>
</div></p>

          <h1 id="bulk-data">Bulk Data</h1>

<p>ControlShift&rsquo;s Bulk Data Webhooks make it easy to pull your data into external services.</p>

<h2 id="webhooks">Webhooks</h2>

<p>We provides two special bulk data webhooks to help you keep an external reporting or analytics database server up to date with information from ControlShift&rsquo;s internal tables. The <a href="#data-full_table_exported">data.full_table_exported</a> and <a href="#data-incremental_table_exported">data.incremental_table_exported</a> webhooks can be consumed to keep an external database mirror containing ControlShift data up to date. This service was built in a database agnostic way, but it should be possible to build a ControlShift -&gt; Amazon Redshift data pipeline using the <a href="#controlshift-to-redshift-pipeline">ControlShift to Redshift Pipeline</a> technique outlines below.</p>

<aside class="notice">
Bulk data webhooks should be automatically included when adding a new webhook endpoint. Please contact support to report any issues with bulk data webhook generation. For testing, you can manually trigger these wehbooks by visiting <code>https://&lt;your controlshift instance&gt;/orgs/export</code> and clicking on &ldquo;New Full Tables Data Export.&rdquo;
</aside>

<h2 id="bulk-data-data-schemas">Bulk Data Data Schemas</h2>

<p>The bulk data webhooks include exports of the following tables.  You can use the links to download CSV headers or a psql schema for each table.</p>

<ul>
<li><code class="prettyprint">attendees</code> - <a href="data/attendees_headers.csv">csv headers</a>/<a href="data/attendees_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">comments</code> - <a href="data/comments_headers.csv">csv headers</a>/<a href="data/comments_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">local_chapter_members</code> - <a href="data/local_chapter_members_headers.csv">csv headers</a>/<a href="data/local_chapter_members_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">locations</code> - <a href="data/locations_headers.csv">csv headers</a>/<a href="data/locations_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">petitions</code> - <a href="data/petitions_headers.csv">csv headers</a>/<a href="data/petitions_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">unsubscribes</code> - <a href="data/unsubscribes_headers.csv">csv headers</a>/<a href="data/unsubscribes_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">blast_emails</code> - <a href="data/blast_emails_headers.csv">csv headers</a>/<a href="data/blast_emails_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">events</code> - <a href="data/events_headers.csv">csv headers</a>/<a href="data/events_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">local_chapters</code> - <a href="data/local_chapters_headers.csv">csv headers</a>/<a href="data/local_chapters_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">members</code> - <a href="data/members_headers.csv">csv headers</a>/<a href="data/members_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">signatures</code> - <a href="data/signatures_headers.csv">csv headers</a>/<a href="data/signatures_schema.sql">sql_schema</a></li>
<li><code class="prettyprint">users</code> - <a href="data/users_headers.csv">csv headers</a>/<a href="data/users_schema.sql">sql_schema</a></li>
</ul>

<p>Additional files:</p>

<ul>
<li>combined schema - <a href="/data/combined_schema.sql">CS_combined_schema.sql</a></li>
<li>zip of all schema files <a href="data/CS_data_assets.zip">CS_data_assets.zip</a></li>
</ul>

<h2 id="controlshift-to-redshift-pipeline">ControlShift to Redshift Pipeline</h2>

<p>Setting up an Amazon Redshift integration should take one to two hours. We&rsquo;ll use a custom <a href="http://docs.aws.amazon.com/lambda/latest/dg/welcome.html">AWS Lamda</a> to receive data from ControlShift&rsquo;s webhook and Amazon&rsquo;s <a href="https://github.com/awslabs/aws-lambda-redshift-loader">Lamda Redshift Loader</a> to load our data into Redshift. For this example, we&rsquo;ll focus on the daily full_table dump, and truncating the previous days data for petitions only. You could also add a second pipeline to add incremental data if you need more frequent updates.</p>

<p>As of this writing, aws-lambda-redshift-loader v2.4.0 only supports a single configuration per Lambda.  This means you&rsquo;ll have to setup a separate Lambda for every table you want to capture. If you want to capture both nightly and incremental dumps, you&rsquo;ll also need to set up one nightly lambda and one incremental lambda per table you want to capture. It can be a little tedious, but remember, the first one is the hardest!</p>

<h3 id="example-flow">Example Flow</h3>

<p><img alt="ControlShift Redshift Flow Chart" src="images/ControlShift_Redshift_flow_transparent.svg" /></p>

<h3 id="redshift-pipeline-setup">Redshift Pipeline Setup</h3>

<p>The core steps to get this up and running are:</p>

<ol>
<li>Setting up S3 buckets to retain file storage</li>
<li>Setting up your custom lambda webhook receiver</li>
<li>Setting up your Redshift database cluster and pre-loading a schema.</li>
<li>Setting up your <code class="prettyprint">aws-lambda-redshift-loader</code> lambda.</li>
<li>Configure your bulk data webhook in the Control Shift settings console.</li>
</ol>

<p><strong>Note:</strong> All resources should be set up in the same AWS region (e.g.: us-east-1) so they can access each other. &ldquo;US Standard&rdquo; and &ldquo;us-east-1&rdquo; are the same thing.</p>

<p><strong>Before starting:</strong> You&rsquo;ll need git, npm, and access to a PostgreSQL connection tool, such as <code class="prettyprint">psql</code> on the command line (Redshift is based on PostgreSQL).</p>

<p>These instructions were prepared for aws-lambda-redshift-loader v2.4.0.</p>

<hr>

<h3 id="setting-up-s3-buckets">Setting Up S3 Buckets</h3>

<ol>
<li>Login to you AWS console and create two s3 buckets for future use.

<ol>
<li>controlshift-receiver - will hold received csv files</li>
<li>controlshift-manifests - will hold resulting manifest files from your aws-lambda-redshift-loader</li>
</ol></li>
<li>That&rsquo;s it. You&rsquo;re done here.</li>
</ol>

<hr>

<h3 id="setting-up-custom-lambda-receiver">Setting Up Custom Lambda Receiver</h3>

<blockquote>
<p>Lambda Receiver Code</p>
</blockquote>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">https</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'https'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'url'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">AWS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'aws-sdk'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">csvReceiver</span><span class="p">(</span><span class="nx">downloadUrl</span><span class="p">,</span> <span class="nx">eventContext</span><span class="p">,</span> <span class="nx">webhookJSON</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">targetBucket</span> <span class="o">=</span> <span class="s1">'controlshift-receiver'</span><span class="p">,</span> <span class="c1">// receiver bucket name</span>
    <span class="nx">s3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AWS</span><span class="p">.</span><span class="nx">S3</span><span class="p">(),</span>
    <span class="nx">firstLineRemoved</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">csvData</span> <span class="o">=</span> <span class="s1">''</span><span class="p">,</span>
    <span class="nx">context</span> <span class="o">=</span> <span class="nx">eventContext</span><span class="p">,</span>
    <span class="nx">receivedJSON</span> <span class="o">=</span> <span class="nx">webhookJSON</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">parseFileName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">url_string</span><span class="p">){</span>
    <span class="nx">path</span> <span class="o">=</span> <span class="nx">url</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">url_string</span><span class="p">).</span><span class="nx">pathname</span>
    <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// Remove Headers</span>
  <span class="kd">var</span> <span class="nx">removeFirstLine</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">chunk</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">firstLineRemoved</span><span class="p">){</span>
      <span class="nx">csvData</span> <span class="o">+=</span> <span class="nx">chunk</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
      <span class="kd">var</span> <span class="nx">buffer</span> <span class="o">=</span> <span class="nx">chunk</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'\n'</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">csvData</span> <span class="o">+=</span> <span class="nx">chunk</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">chunk</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'\n'</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="nx">firstLineRemoved</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">buffer</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">uploadCsv</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">upload_details</span> <span class="o">=</span> <span class="p">{</span><span class="na">Bucket</span><span class="p">:</span> <span class="nx">targetBucket</span><span class="p">,</span> <span class="na">Key</span><span class="p">:</span> <span class="nx">fileName</span><span class="p">,</span> <span class="na">Body</span><span class="p">:</span> <span class="nx">csvData</span><span class="p">};</span>
    <span class="nx">s3</span><span class="p">.</span><span class="nx">upload</span><span class="p">(</span><span class="nx">upload_details</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">){</span>
        <span class="c1">// an error occurred</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">stack</span><span class="p">);</span>
        <span class="nx">context</span><span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
      <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="c1">// successful response</span>
        <span class="nx">context</span><span class="p">.</span><span class="nx">succeed</span><span class="p">({</span><span class="s2">"status"</span><span class="p">:</span> <span class="s2">"success"</span><span class="p">,</span> <span class="s2">"payload"</span><span class="p">:</span> <span class="nx">receivedJSON</span><span class="p">});</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">{</span>
    <span class="na">processCsv</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
      <span class="nx">fileName</span> <span class="o">=</span> <span class="nx">parseFileName</span><span class="p">(</span><span class="nx">downloadUrl</span><span class="p">);</span>
      <span class="nx">https</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">downloadUrl</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">httpResponse</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">httpResponse</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'data'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">chunk</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">removeFirstLine</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="nx">httpResponse</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'end'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">httpResponse</span><span class="p">);</span>
          <span class="nx">uploadCsv</span><span class="p">();</span>
        <span class="p">});</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Lambda event Handler</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">receivedJSON</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Received event:'</span><span class="p">,</span> <span class="nx">receivedJSON</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="s1">'data.full_table_exported'</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">receiver</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">csvReceiver</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">receivedJSON</span><span class="p">);</span>
    <span class="nx">receiver</span><span class="p">.</span><span class="nx">processCsv</span><span class="p">();</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nx">context</span><span class="p">.</span><span class="nx">succeed</span><span class="p">({</span><span class="s2">"status"</span><span class="p">:</span> <span class="s2">"skipped"</span><span class="p">,</span> <span class="s2">"payload"</span><span class="p">:</span> <span class="nx">receivedJSON</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre>

<p>From the Lambda management console, you&rsquo;ll need to do the following.</p>

<h4 id="create-the-receiver-lambda">Create the Receiver Lambda</h4>

<ol>
<li>Click to create a new Lambda function.</li>
<li>Skip the existing blueprints (button towards the bottom of page)</li>
<li>Name your function something like &ldquo;controlShiftWebhookReciever&rdquo; and leave the runtime to node default.</li>
<li>Copy and paste the &ldquo;Lambda Receiver&rdquo; function from the right into the inline lambda code editor.</li>
<li>Update the <code class="prettyprint">targetBucket</code> in the inline code editor (approximately line 6 after copying/pasting).</li>
<li>Leave the handler as the default.</li>
<li>For role, select &ldquo;S3 Execution role&rdquo;. This will open a new window.</li>
<li>In this new window, called &ldquo;IAM Management Console&rdquo;, the IAM role field should say &ldquo;Create a new role.&rdquo; Name this new role something relevant, like &ldquo;controlShiftReceriver_s3.&rdquo; Then click &ldquo;Allow&rdquo; in the far bottom left corner, this returns you to the previous window.</li>
<li>Next, set the memory size to 128MB. If you have a large petitions DB, you will likely need more. You can always update the memory size later and you can check the log stream in CloudWatch monitoring to see how much memory was used.</li>
<li>Set the Timeout a little higher - 30 seconds should be fine.</li>
<li>Use &ldquo;No VPC&rdquo;.</li>
<li>Click next, then on the next page just click &ldquo;Create Function&rdquo;!</li>
</ol>

<h4 id="setup-the-api-endpoint">Setup the API Endpoint</h4>

<p>Now that we have our Lambda setup, we need to be able to POST to it from your Control Shift instance.</p>

<ol>
<li>If not already there, go back to the Receiver Lambda we just created.</li>
<li>Click on the &ldquo;API Endpoints&rdquo; tab and click to add a new endpoint.</li>
<li>Select an API Gateway.</li>
<li>Set the Method to POST and Security to Open.</li>
<li>Click create. Done!</li>
</ol>

<hr>

<h3 id="setting-up-redshift-database">Setting Up RedShift Database</h3>

<p>Click on Redshift service in the AWS console.</p>

<h4 id="launch-your-cluster">Launch Your Cluster</h4>

<ol>
<li>Click to create your cluster.</li>
<li>Setup a identifier, database name, master user name and password as you desire and click next. Let&rsquo;s use these values for this example:

<ul>
<li>Cluster: control-shift-cluster</li>
<li>Database name: controlshiftdb</li>
<li>Port: Leave the default</li>
<li>Master Username: masteruser</li>
</ul></li>
<li>Use the defaults on the next two screens, &ldquo;Node Configuration&rdquo; and &ldquo;Additional Configuration, just click next.</li>
<li>Then Launch!</li>
<li>Once the creation and launch process finishes, you can click to view your new cluster&rsquo;s properties, which will include an  endpoint address. Save that address somewhere. Example: <code class="prettyprint">control-shift-cluster.xXxXxX00Xx.us-east-1.redshift.amazonaws.com</code></li>
</ol>

<h4 id="prepare-redshift-connection-security">Prepare Redshift Connection Security</h4>

<p>We need to whitelist relevant IP addresses in our default security group. We&rsquo;ll need to add two rules. While we&rsquo;re managing our security through a VPC (Virtual Private Cloud), the best UI for our purposes is actually in the EC2 configuration console.</p>

<ol>
<li>Go to the AWS Console &gt; EC2</li>
<li>Click on &quot;Security Groups&rdquo; in the left hand menu.</li>
<li>Click on the default Security Group (it should say default in the &ldquo;Group Name&rdquo; column)</li>
<li>Click on the &ldquo;Inbound Rules&rdquo; tab at the bottom and click &ldquo;Edit.&rdquo;</li>
<li>Click &ldquo;Add Rule&rdquo; to start adding our first rule.</li>
<li>Select &ldquo;All Traffic&rdquo; for &ldquo;type&rdquo; and for &ldquo;source&rdquo; select &ldquo;My IP.&rdquo; This should pre-fill your CIDR.  Save the new rule.</li>
<li>Click &ldquo;Add Rule&rdquo; again.</li>
<li>Select &ldquo;Redshift&rdquo; for &ldquo;Type.&rdquo; Enter your cluster&rsquo;s port (typically 5439). Type &ldquo;sg-&rdquo; into the source field, and it should pull up your default security group.</li>
</ol>

<p><strong>Note:</strong> If you&rsquo;re having trouble getting your own IP/CIDR setup, try either looking up your subnet mask and using <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks">this table</a>. Your CIDR will almost always be your ip address followed by <code class="prettyprint">/32</code> or <code class="prettyprint">/64</code> for ipv6.  Example: <code class="prettyprint">123.123.123.123/32</code>. If all else fails, use the &ldquo;Anywhere&rdquo; global option <code class="prettyprint">0.0.0.0/0</code> - opening your cluster to the public Internet. The latter isn&rsquo;t recommended. If you do have to do this, make sure you remove the rule when you&rsquo;re done.</p>

<h4 id="prepare-redshift-schema">Prepare Redshift Schema</h4>

<p>We need to prep our tables data schema to receive our ControlShift Data.  We&rsquo;ll use <code class="prettyprint">psql</code> for this.</p>

<ol>
<li>Install <code class="prettyprint">psql</code> if you don&rsquo;t have it already.</li>
<li>Download the current schema for our petitions table as <a href="/data/petitions_schema.sql" target="_blank">petitions_schema.sql</a>.</li>
<li>Finally, you&rsquo;ll need to load that schema into your table with the following command:</li>
</ol>

<p><code class="prettyprint">psql -h &lt;cluster_endpoint&gt; -U &lt;database_user&gt; -d &lt;database_name&gt; -p &lt;cluster_port&gt; -f petitions_schema.sql</code></p>

<p><strong>Note:</strong> When connecting, you should almost immediately get a request for your password. If your connection is timing out <em>before</em> you enter your password, there is an authorization issue. If you are timing out <em>after</em> connecting, you can extend your keep alive timeout with the following shell command.</p>

<p><code class="prettyprint">sudo /sbin/sysctl -w net.ipv4.tcp_keepalive_time=200 net.ipv4.tcp_keepalive_intvl=200 net.ipv4.tcp_keepalive_probes=5</code></p>

<h4 id="creating-a-database-user-amp-granting-privileges">Creating a Database User &amp; Granting Privileges</h4>

<blockquote>
<p>Creating a user and granting INSERT Privileges</p>
</blockquote>
<pre class="highlight sql"><code><span class="k">CREATE</span> <span class="k">USER</span> <span class="n">redshift_user</span> <span class="n">PASSWORD</span> <span class="n">PlainTextPassword123</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">petitions</span> <span class="k">OWNER</span> <span class="k">TO</span> <span class="n">redshift_user</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">INSERT</span> <span class="k">ON</span> <span class="n">petitions</span> <span class="k">TO</span> <span class="n">redshift_user</span><span class="p">;</span>
</code></pre>

<p>We need to allow our user to access our aws-lambda-redshift-loader to access our Redshift database. Connect via psql and create your user and grant permissions. See code example.</p>

<p><code class="prettyprint">psql -h &lt;cluster_endpoint&gt; -U &lt;database_user&gt; -d &lt;database_name&gt; -p &lt;cluster_port&gt;</code></p>

<p><strong>Security Notes:</strong></p>

<ul>
<li>Typically, we&rsquo;d like to limit the privileges we&rsquo;re granting our redshift_user to just INSERT and TRUNCATE. Unfortunately, Redshift doesn&rsquo;t allow us to specifically grant TRUNCATE permissions. Thus, our redshift_user must own the table.</li>
<li>In PostgreSQL, we wouldn&rsquo;t need to grant INSERT privileges to the owner, but Redshift seems to need this.</li>
<li>For Redshift cluster versions &gt; 1.0.1046, you can store your password as a MD5 hash instead of cleartext. At the time of this writing, most clusters are on version 1.0.1044. See the md5 section of the <a href="http://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_USER.html">create user documentation</a>.</li>
</ul>

<hr>

<h3 id="setting-up-aws-lambda-redshift-loader">Setting up aws-lambda-redshift-loader</h3>

<h4 id="deploying-the-aws-lambda-redshift-loader-function">Deploying the aws-lambda-redshift-loader Function</h4>

<blockquote>
<p>AWS Lambda Execution Role</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"Version"</span><span class="p">:</span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"Statement"</span><span class="p">:[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"Sid"</span><span class="p">:</span><span class="s2">"Stmt1424787824000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"Action"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"dynamodb:DeleteItem"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:DescribeTable"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:GetItem"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:ListTables"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:PutItem"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:Query"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:Scan"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dynamodb:UpdateItem"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:GetEndpointAttributes"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:GetSubscriptionAttributes"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:GetTopicAttributes"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:ListTopics"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:Publish"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:Subscribe"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"sns:Unsubscribe"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:Get*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:Put*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"s3:List*"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"kms:Decrypt"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"kms:DescribeKey"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"kms:GetKeyPolicy"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"Resource"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"*"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"Action"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"logs:CreateLogGroup"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"logs:CreateLogStream"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"logs:PutLogEvents"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"Resource"</span><span class="p">:</span><span class="s2">"arn:aws:logs:*:*:*"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"Effect"</span><span class="p">:</span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"Action"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"ec2:CreateNetworkInterface"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ec2:DescribeNetworkInterfaces"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ec2:DetachNetworkInterface"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ec2:DeleteNetworkInterface"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nt">"Resource"</span><span class="p">:</span><span class="s2">"*"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<ol>
<li>Go to the AWS Lambda Console in the same region as your S3 bucket and Amazon Redshift cluster.</li>
<li>Select Create a Lambda function and enter a name (e.g.: controlShiftRedshiftLoader).</li>
<li>Clone the <a href="https://github.com/awslabs/aws-lambda-redshift-loader">Amazon Redshift Database Loader</a> repository locally</li>
<li>Under Code entry type select &lsquo;Upload a zip file&rsquo; and upload the AWSLambdaRedshiftLoader-2.4.0.zip file from the &ldquo;dist&rdquo; directory on the repository you just cloned.</li>
<li>Set the Runtime to Node.js 0.10.</li>
<li>Use the default values for the handler, and in the Role drop-down, select &ldquo;* Basic Execution Role.&rdquo; A IAM creation wizard will open in a new window.</li>
<li>Follow the wizard, selecting to &ldquo;Create a new IAM Role&rdquo; and name it as you like.  Click to &ldquo;View the Policy&rdquo; and then click edit.</li>
<li>Copy and paste the the AWS Lambda Execution Role permissions from the right.</li>
<li>Then click &ldquo;Add Policy.&rdquo; Select the <code class="prettyprint">AmazonRedshiftFullAccess</code> role and add it, then add another role - <code class="prettyprint">AmazonDMSRedshiftS3Role</code>.</li>
<li>Navigate back to your Lambda setup tab and set the max timeout (5 minutes) to accommodate potentially long COPY times.</li>
<li>From the VPC dropdown, select your default VPC.</li>
<li>Leave the rest of the settings unchanged.</li>
<li>Click next and then click to create your Lambda.</li>
</ol>

<h4 id="establishing-an-event-source">Establishing an Event Source</h4>

<p>Once deployed, you need to add an event source:</p>

<ol>
<li>Select &ldquo;Event Source&rdquo; tab and click to &ldquo;Add event source.&rdquo;</li>
<li>The event source type should be set to S3.</li>
<li>Select the S3 bucket you want to use for input data - controlshift-receiver.</li>
<li>Select the &#39;Object Created (All)&rsquo; notification type.</li>
</ol>

<h4 id="configuration-prep">Configuration Prep</h4>

<p>Setup your AWS credentials as environment variables as follows:
<code class="prettyprint">export AWS_ACCESS_KEY_ID=XXXXXXXXX AWS_SECRET_ACCESS_KEY=XXXXXXXXXXX AWS_REGION=us-east-1</code></p>

<h4 id="running-setup-js">Running setup.js</h4>

<ol>
<li>After setting up your environment, head to your local copy of aws-lambda-redshift-loader.</li>
<li>run <code class="prettyprint">npm install</code> to install package&rsquo;s dependencies.</li>
<li>run <code class="prettyprint">node setup.js</code>.</li>
<li>The script will request various configuration options.  Some sensible responses for our use case are below. Empty responses were just skipped.</li>
</ol>

<table><thead>
<tr>
<th></th>
</tr>
</thead><tbody>
<tr>
<td>Enter the Region for the Configuration &gt; us-east-1</td>
</tr>
<tr>
<td>Enter the S3 Bucket &amp; Prefix to watch for files &gt; controlshift-receiver</td>
</tr>
<tr>
<td>Enter a Filename Filter Regex &gt;</td>
</tr>
<tr>
<td>Enter the Cluster Endpoint &gt; control-shift-cluster.xXxXxX00Xx.us-east-1.redshift.amazonaws.com</td>
</tr>
<tr>
<td>Enter the Cluster Port &gt; 5439</td>
</tr>
<tr>
<td>Does your cluster use SSL (Y/N)  &gt; Y</td>
</tr>
<tr>
<td>Enter the Database Name &gt; controlshiftdb</td>
</tr>
<tr>
<td>Enter the Table to be Loaded &gt; petitions</td>
</tr>
<tr>
<td>Enter the comma-delimited column list (optional) &gt; (Copy and paste from our <a href="data/petitions_headers.csv">petitions_headers.csv</a>)</td>
</tr>
<tr>
<td>Should the Table be Truncated before Load? (Y/N) &gt; Y # Don&rsquo;t truncate if this lambda will handle incremental builds.</td>
</tr>
<tr>
<td>Enter the Database Username &gt; masteruser # Or any user you created in psql</td>
</tr>
<tr>
<td>Enter the Database Password &gt; SuPeRs8CuR1tY # your password</td>
</tr>
<tr>
<td>Enter the Data Format (CSV, JSON or AVRO) &gt; CSV</td>
</tr>
<tr>
<td>Enter the CSV Delimiter &gt; ,</td>
</tr>
<tr>
<td>Enter the S3 Bucket for Redshift COPY Manifests &gt; controlshift-manifests</td>
</tr>
<tr>
<td>Enter the Prefix for Redshift COPY Manifests &gt; manifests</td>
</tr>
<tr>
<td>Enter the Prefix to use for Failed Load Manifest Storage &gt; failed</td>
</tr>
<tr>
<td>Enter the Access Key used by Redshift to get data from S3. If NULL then Lambda execution role credentials will be used &gt; <aws key></td>
</tr>
<tr>
<td>Enter the Secret Key used by Redshift to get data from S3. If NULL then Lambda execution role credentials will be used &gt; <aws key></td>
</tr>
<tr>
<td>Enter the SNS Topic ARN for Successful Loads &gt;</td>
</tr>
<tr>
<td>Enter the SNS Topic ARN for Failed Loads &gt;</td>
</tr>
<tr>
<td>How many files should be buffered before loading? &gt; 1</td>
</tr>
<tr>
<td>How old should we allow a Batch to be before loading (seconds)? &gt; 120</td>
</tr>
<tr>
<td>Additional Copy Options to be added &gt;</td>
</tr>
<tr>
<td>If Encrypted Files are used, Enter the Symmetric Master Key Value &gt;</td>
</tr>
</tbody></table>

<hr>

<h3 id="configure-controlshift-39-s-webhook">Configure ControlShift&rsquo;s webhook</h3>

<p>Finally, you&rsquo;ll need to log into your admin panel.  Settings &gt; CRM Integrations &amp; Webhooks &gt; Configure Webhook Endpoints.  Then add a bulk data webhook pointing at your Lambda endpoint.</p>

<h3 id="troubleshooting-errors">Troubleshooting Errors</h3>

<blockquote>
<p>Example LambdaRedshiftBatches error</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"control-shift-cluster.ckcgajpfnj82.us-east-1.redshift.amazonaws.com"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="mi">-1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"error"</span><span class="p">:{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"error"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"length"</span><span class="p">:</span><span class="mi">143</span><span class="p">,</span><span class="w">
      </span><span class="nt">"severity"</span><span class="p">:</span><span class="s2">"FATAL"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"code"</span><span class="p">:</span><span class="s2">"28000"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"file"</span><span class="p">:</span><span class="s2">"/home/awsrsqa/padb/src/pg/src/backend/libpq/auth.c"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"line"</span><span class="p">:</span><span class="s2">"402"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"routine"</span><span class="p">:</span><span class="s2">"auth_failed"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>A few tips if things aren&rsquo;t working:</p>

<ul>
<li>Most errors will probably occur when attempting to load data from Lambda into Redshift. The DynamoDB batch history captures errorMessages in the the <code class="prettyprint">LambdaRedshiftBatches</code> table. Click on the <code class="prettyprint">entries</code> field. You can also check AWS CloudWatch &gt; Logs and then click on the appropriate cloud stream.</li>
<li>If you&rsquo;re DynamoDB batch history is empty, but your lambda is being invoked, and AWS CloudWatch logs show timeout errors, your Lambda probably cannot connect to your DynamoDB instance. Try moving your aws-lamda-loader out of the VPC group.</li>
<li>Since Redshift is based on PostgreSQL 8.0.2, there is a healthy amount of overlapping error codes. You can <a href="http://www.postgresql.org/docs/8.0/static/errcodes-appendix.html">lookup errors codes here</a>. Example errors:

<ul>
<li><code class="prettyprint">28000</code> - Unable to connect to the database. Is the username/password/database name entered correctly when running setup.js? Is the user granted proper privileges on your database?</li>
<li><code class="prettyprint">42P01</code> - Redshift doesn&rsquo;t have the table you&rsquo;re trying to import data into. Did you import the schema as described above?</li>
<li><code class="prettyprint">XX000</code> - This is an internal error. In our case, the most likely causes are either an invalid schema usually caused by an <a href="http://docs.aws.amazon.com/redshift/latest/dg/c_unsupported-postgresql-datatypes.html">unsupported data type</a>. Double check that your imported schema is correct. If you aren&rsquo;t using the provided schema, double check that you&rsquo;re using the supported types and that your imported data matches those types.</li>
<li><code class="prettyprint">42601</code> - Syntax error - This is most likely a typo when running setup.js. If you&rsquo;re entering your CSV columns during setup, be sure they match the schema you&rsquo;ve loaded into the database. Make sure your CSV Delimiter is set correctly and your CSV is properly formated.</li>
<li><code class="prettyprint">42501</code> - Insufficient privileges errors.  Did you GRANT your user all the privileges required?</li>
</ul></li>
<li>Try manually uploading a petitions export to your <code class="prettyprint">controlshift-receiver</code> S3 bucket, and check DynamoDB batch history for errors. You can fetch these exports from your ControlShift Labs instance, in Settings &gt; Exports.

<ul>
<li>If you get an error message &ldquo;Unknown Error during Customer Master Key describe&rdquo; when running setup.js, you probably didn&rsquo;t <code class="prettyprint">export</code>the environment params as described above.</li>
</ul></li>
</ul>

          <h1 id="authenticated-rest-api">Authenticated REST API</h1>

<p>The Authenticated REST API allows customers to build applications that interact with their own data or securely grant access to third-party app developers without exposing administrative credentials. It is designed to be consumed server-side, in contrast to the JSONP API which is designed for unauthenticated javascript integrations. </p>

<p>We use <a href="http://oauth.net/2/">OAuth2</a> to allow organizations to securely grant access to API Applications. OAuth2 is a standardized protocol that allows user credentials to be exchanged for a secret token which can then be used to access an API. There are OAuth2 implementations available for most common programming languages. You&rsquo;ll probably want to read some general documentation on how OAuth2 works before attempting to use this API. </p>

<p>An <em>API Application</em> must be configured within your ControlShift instance before using the API. Access is then granted to this application, and exchanged for a token which is used to authenticate your access to API endpoints.   </p>

<h2 id="quickstart-guide">Quickstart Guide</h2>

<p>There are two ways to get set up to use the authenticated API. Use whichever is easier for you. <em>You only need to do one of these.</em></p>

<h3 id="the-easy-way-client-credentials">The Easy Way: Client Credentials</h3>

<ol>
<li><p><strong>Set up a new API Application</strong> Log in as an Organisation Owner and navigate to Settings &gt; Integrations &gt; Configure API Applications. Add a New Application. Use urn:ietf:wg:oauth:2.0:oob as the callback URL unless you plan to allow self-service application authorization.</p></li>
<li><p>Clone the <a href="https://github.com/controlshift/oauth-api-example">oauth-api-example</a> github repo.</p></li>
<li><p>Follow the instructions in the README.md file to get that example working with your credentials.</p></li>
<li><p>Do something similar in your actual code.</p></li>
</ol>

<h3 id="the-hard-way-application-and-token-exchange">The Hard Way: Application and Token Exchange</h3>

<p>These are the steps to setup a new API Application and to use that new API Application to access platform resources through OAuth2. In a production context, automating these steps is recommended. </p>

<blockquote>
<p>Use cURL to do the token exchange</p>
</blockquote>
<pre class="highlight shell"><code>curl -X POST --header <span class="s2">"Content-Type: application/json"</span> --header <span class="s2">"Accept: application/json"</span> --data <span class="s1">'{"grant_type":"authorization_code", "code":"{code}", "client_id":"{client_id}", "client_secret":"{client_secret}", "redirect_uri":"{redirect_uri}"}'</span> https://foo.controlshiftlabs.com/oauth/token
</code></pre>

<ol>
<li><p><strong>Set up a new API Application</strong> Log in as an Organisation Owner and navigate to Settings &gt; Integrations &gt; Configure API Applications. Add a New Application. Use urn:ietf:wg:oauth:2.0:oob as the callback URL unless you plan to allow self-service application authorization.</p></li>
<li><p><strong>Generate Authorization Code</strong> From the API Application show page, click &ldquo;Authorize&rdquo;. This will generate a code that can be exchanged with a token to act as the currently signed in user. After the authorization is approved, an authorization code should be displayed. Record this code for the next step. </p></li>
<li><p><strong>Exchange Authorization Code for Token</strong> Take the authorization code from the previous step and exchange it for an OAuth2 Token. </p>

<p><code class="prettyprint">POST https://foo.controlshiftlabs.com/oauth/token
  client_id=...
  redirect_uri=...
  grant_type=authorization_code
  client_secret=...
  code=...</code></p></li>
<li><p><strong>Use Token to Access API</strong> The token can now be used to access API endpoints as the authorized user. </p>

<p><code class="prettyprint">GET https://foo.controlshiftlabs.com/api/v1/organisation?access_token={token}</code></p>

<p>Should return a json representation of the current organisation. See documentation for other endpoints that are available. </p></li>
</ol>

<p>We&rsquo;ve also written an example <a href="https://github.com/controlshift/controlshift-oauth-example">of this same work flow</a> in ruby using the oauth2 gem. </p>

<p>In most production scenarios instead of manually performing the authorization, and exchanging the code for a token, this setup process would be automated. See your oauth2 library documentation for more information. </p>

          <h2 id="organisation">Organisation</h2>

<h3 id="retrieve">Retrieve</h3>

<p>Get up to date statistics about the current organisation.</p>

<blockquote>
<p>GET /api/v1/organisation</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"organisation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"petitions_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signatures_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nt">"blast_emails_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"members_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h2 id="members">Members</h2>

<p>The platform transparently creates a member record for any email address that creates a user account, signs a petition, or attends an event. Members are unique by email address, and all 
platform activity is tracked by member id.  </p>

<h3 id="lookup">Lookup</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="err">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Find a member by email address. Once you have obtained a member id you can use this identifier in other API calls. </p>

<p><code class="prettyprint">GET /api/v1/members/lookup?email=foo@bar.com</code></p>

<h3 id="show">Show</h3>

<p>Find a member by id. Member ids can be discovered via a call to the lookup API. </p>

<p><code class="prettyprint">GET /api/v1/members/123</code></p>

<h3 id="destroy">Destroy</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Permanently deletes a member with specified id and all associated records including petitions, signatures, events. The deletion feature is designed to honor requests from members around the right to be forgotten.</p>

<p><code class="prettyprint">DELETE /api/v1/members/123</code></p>

<p>Deletes are synchronous and may take several seconds depdending on how many resources are owned by the member. </p>

<p>Ownership of Petitions and Events created by the deleted member will be re-assigned to the user account specified in the organisation&rsquo;s settings. </p>

<h3 id="unsubscribe">Unsubscribe</h3>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"member"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"unsubscribed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">123</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Unsubscribes a member with specified id from emails from event hosts and petiton creators. Member will still receive transactional emails, and will be resubscribed if they opt in while signing a new petition or attending a new event, etc. </p>

<p><code class="prettyprint">POST /api/v1/members/123/unsubscribe</code></p>

          <h2 id="petitions">Petitions</h2>

<p>Petition are pieces of content that can be signed by members. </p>

<h3 id="show">Show</h3>

<blockquote>
<p>GET response Body</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"slug"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no-taxes-on-tea"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No Taxes on Tea"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"who"</span><span class="p">:</span><span class="w"> </span><span class="s2">"King George"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"what"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Stop taxing our tea"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"why"</span><span class="p">:</span><span class="w"> </span><span class="s2">"It is unjust."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"signature_count_add_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Find information about a petition by URL slug.</p>

<p><code class="prettyprint">GET /api/v1/petitions/no-taxes-on-tea</code></p>

<h3 id="update">Update</h3>

<p>Updates petition content using an HTTP PUT request.</p>

<p>We support several request formats for the data to be updated, but the most straightforward is to send the data as a json formatted PUT body. </p>

<p>In the request body only include the fields that you would like to update to a new value. The slug in the URL defines which petition should be updated. </p>

<p><code class="prettyprint">PUT /api/v1/petitions/no-taxes-on-tea</code></p>

<blockquote>
<p>PUT request body</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"petition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"signature_count_add_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
          </div>
      </div>
    </div>
    <script>
      $(document).ready(function(){
        var defaultOptions = {
          "title": "ControlShift Labs Example",
          "editors": "101",
          "html": "Oops.  There has been an error.",
          "js": "",
          "css_external": "https://netdna.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css",
          "js_library": "jquery"
        }

        $.each($('.js-codepen-data'), function(index, codePenHTML){
          $codePenDomObject = $(codePenHTML);
          var dataOptions = jQuery.extend({}, defaultOptions);
          dataOptions = jQuery.extend(dataOptions, $codePenDomObject.data());
          dataOptions.html = '  <div class="container">';
          dataOptions.html += $codePenDomObject.find('.codepen-html').html();
          dataOptions.html += '</div>';
          dataOptions.js = $codePenDomObject.find('.codepen-js').html();
          $codePenDomObject.next().removeClass('hidden').find('.js-data').val(JSON.stringify(dataOptions));
        });
      });
    </script>
  </body>
</html>
